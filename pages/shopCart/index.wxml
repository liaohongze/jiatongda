<!--pages/shopCart/index.wxml-->
<i-tabs current="{{ current }}" color="#00c482" bindchange="tabsChange">
  <i-tab key="tab1" title="标准产品服务"></i-tab>
  <i-tab key="tab2" title="师傅报价服务"></i-tab>
</i-tabs>

<view class='tab_container' wx:if='{{current === "tab1"}}'>
  <checkbox-group bindchange="categoryChange">
    <view class='order' wx:for='{{list1}}' wx:key='{{index}}'>
      <view class='c_title'>
        <checkbox value="{{item.c_id}}" checked="{{item.checked}}" data-index='{{index}}' bindtap='cateTap' />
        <text>{{item.c_name}}</text>
      </view>
      <checkbox-group bindchange="productChange">
        <view class='product' wx:for='{{item.product_list}}' wx:for-index="prodIndex" wx:for-item="prod" wx:key='{{prodIndex}}'>
          <view class='prod_name'>
            <checkbox value='{{index + "," + prodIndex}}' checked="{{prod.checked}}" data-index='{{index}}' data-prodindex='{{prodIndex}}' bindtap='prodTap' />
            <text>{{prod.p_name}}</text>
          </view>
          <checkbox-group bindchange="skuChange">
            <view class='sku' wx:for='{{prod.sku_list}}' wx:for-index='skuIndex' wx:for-item='sku' wx:key='{{skuIndex}}'>
              <checkbox value='{{index + "," + prodIndex + "," + skuIndex}}' checked="{{sku.checked}}" data-index='{{index}}' data-prodindex='{{prodIndex}}' data-skuindex='{{skuIndex}}' bindtap='skuTap' />
              <view class='sku_title'>{{sku.product_type}} {{sku.product_guige}}</view>
              <view class='price_n_count'>
                <view class='price'>￥{{sku.price}}</view>
                <i-input-number value="{{ sku.count }}" min="1" max="100" step="1" bindchange="countChange" />
              </view>
            </view>
          </checkbox-group>
        </view>
      </checkbox-group>

      <navigator url='../address/index?from=startAddr&id={{product.p_id}}' class='addr' wx:if="{{product.sku.isMoreAddr}}">
        <image src='../../img/icon-start.png' mode='aspectFit' />
        <view class='info'>
          <text>{{item.startAddr.name}} {{item.startAddr.mobile}}</text>
          <view>{{item.startAddr.address}}</view>
        </view>
        <view class='icon'>
          <i-icon type="enter" size="24" color="#cccccc" />
        </view>
      </navigator>

      <navigator url='../address/index?from=endAddr&id={{product.p_id}}' class='addr'>
        <image src='../../img/icon-end.png' mode='aspectFit' />
        <view class='info'>
          <text>{{item.endAddr.name}} {{item.endAddr.mobile}}</text>
          <view>{{item.endAddr.address}}</view>
        </view>
        <view class='icon'>
          <i-icon type="enter" size="24" color="#cccccc" />
        </view>
      </navigator>

      <view class='coupon' catchtap='selectCoupon'>
        <view class='left_side'>
          <i-icon type="coupons" size="26" color="#09bb07" />
          <text>优惠券</text>
        </view>
        <view class='right_side'>
          <text wx:if="{{order.coupon.count > 0}}">￥{{order.coupon.count}}</text>
          <text wx:else>{{couponMsg}}</text>
          <i-icon type="enter" size="24" color="#cccccc" />
        </view>
      </view>

      <view class='time'>
        <text>时间</text>
        <text>{{item.time}}</text>
      </view>
    </view>
  </checkbox-group>
</view>

<view class='foot_space'></view>

<view class='footer'>
  <checkbox-group bindchange="checkAllChange">
    <checkbox value='list1.c_name' checked="{{allChecked}}" bindtap='checkAll' />全选
  </checkbox-group>

  <view class='price_n_btn'>
    <text>应付金额：￥{{allPrice}}</text>
    <button>去结算</button>
  </view>
</view>

<view class='loading' wx:if="{{isLoading}}">
  <i-spin i-class='loading_icon' fix></i-spin>
</view>

<view class='nomore' wx:if="{{showNoMore}}">没有更多数据了</view>